<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pterodactyl Auto Cleaner - RezzX Panel</title>
  <style>
    body {
      background: #0f172a;
      color: #f1f5f9;
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 30px;
    }

    h1 {
      text-align: center;
      color: #38bdf8;
    }

    .container {
      max-width: 600px;
      margin: auto;
      background: #1e293b;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 0 10px #38bdf8;
    }

    input {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      background: #0f172a;
      border: 2px solid #38bdf8;
      color: #f1f5f9;
      border-radius: 10px;
      font-size: 14px;
    }

    button {
      width: 100%;
      background: #38bdf8;
      color: #0f172a;
      border: none;
      padding: 12px;
      font-weight: bold;
      font-size: 16px;
      border-radius: 10px;
      cursor: pointer;
    }

    button:hover {
      background: #0ea5e9;
    }

    .log {
      margin-top: 20px;
      background: #0f172a;
      border: 1px solid #334155;
      padding: 15px;
      border-radius: 10px;
      max-height: 300px;
      overflow-y: auto;
      white-space: pre-line;
    }

    .success { color: #22c55e; }
    .fail { color: #ef4444; }
    .info { color: #facc15; }

    .rainbow {
      font-weight: bold;
      background: linear-gradient(to right, red, orange, yellow, green, cyan, blue, violet);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-align: center;
      margin-top: 20px;
      font-size: 20px;
    }
  </style>
</head>
<body>
  <h1>üßπ Pterodactyl Auto Cleaner - RezzX Panel</h1>

  <div class="container">
    <input type="text" id="plta" placeholder="üîë API KEY Application (Admin)">
    <input type="text" id="pltc" placeholder="üîê API KEY Client (Owner)">
    <input type="text" id="domain" placeholder="üåê Domain Panel (https://yourpanel.com)">
    <button onclick="hapusServer()">üöÄ Gas Bersihin Server Offline</button>
    <div id="log" class="log"></div>
    <div id="done" class="rainbow"></div>
  </div>

  <script>
    async function hapusServer() {
      const plta = document.getElementById('plta').value.trim();
      const pltc = document.getElementById('pltc').value.trim();
      const domain = document.getElementById('domain').value.trim();
      const log = document.getElementById('log');
      const done = document.getElementById('done');
      log.innerHTML = '';
      done.innerHTML = '';

      if (!plta || !pltc || !domain) {
        log.innerHTML = `<span class="fail">‚ùå Semua field wajib diisi.</span>`;
        return;
      }

      log.innerHTML = `<span class="info">‚è≥ Memulai proses pembersihan server...</span>\n`;

      try {
        const res = await fetch("https://candid-trifle-a2dbc3.netlify.app/api/deleteOffline", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ plta, pltc, domain })
        });

        let data;
        try {
          data = await res.json();
        } catch {
          const raw = await res.text();
          throw new Error(`Gagal parsing response JSON:\n${raw}`);
        }

        if (!data || data.error) {
          log.innerHTML += `\n<span class="fail">‚ùå Gagal: ${data?.error || 'Response kosong/tidak valid'}</span>`;
          return;
        }

        data.log.forEach(l => {
          if (l.includes('‚úÖ')) {
            log.innerHTML += `<span class="success">${l}</span>\n`;
          } else if (l.includes('‚ùå')) {
            log.innerHTML += `<span class="fail">${l}</span>\n`;
          } else {
            log.innerHTML += `<span class="info">${l}</span>\n`;
          }
        });

        done.innerHTML = `üéâ SEMUA PROSES SELESAI üéâ`;
        document.getElementById('plta').value = '';
        document.getElementById('pltc').value = '';
        document.getElementById('domain').value = '';
      } catch (e) {
        log.innerHTML += `\n<span class="fail">‚ùå Error: ${e.message}</span>`;
      }
    }
  </script>
</body>
</html>
